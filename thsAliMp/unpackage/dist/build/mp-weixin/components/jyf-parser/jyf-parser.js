(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/jyf-parser/jyf-parser"],{"155c":function(t,e,n){"use strict";var i,s=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},"195c":function(t,e,n){},a744:function(t,e,n){"use strict";n.r(e);var i=n("155c"),s=n("b7c6");for(var a in s)"default"!==a&&function(t){n.d(e,t,(function(){return s[t]}))}(a);n("b354");var o,r=n("f0c5"),l=Object(r["a"])(s["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],o);e["default"]=l.exports},b354:function(t,e,n){"use strict";var i=n("195c"),s=n.n(i);s.a},b7c6:function(t,e,n){"use strict";n.r(e);var i=n("d4aa"),s=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=s.a},d4aa:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,s=function(){n.e("components/jyf-parser/libs/trees").then(function(){return resolve(n("53ae"))}.bind(null,n)).catch(n.oe)},a=n("3826"),o=getApp().parserCache={},r=n("2cbc"),l=t.getFileSystemManager?t.getFileSystemManager():null;function c(t){for(var e=t.length,n=5381;e--;)n+=(n<<5)+t.charCodeAt(e);return n}var h=n("4a98"),u=t.createAnimation({timingFunction:"ease"}).opacity(1).step().export(),f={name:"parser",data:function(){return{showAnimation:"",controls:{},nodes:[]}},components:{trees:s},props:{html:null,autopause:{type:Boolean,default:!0},autosetTitle:{type:Boolean,default:!0},domain:String,gestureZoom:Boolean,lazyLoad:Boolean,selectable:Boolean,tagStyle:Object,showWithAnimation:Boolean,useAnchor:Boolean,useCache:Boolean},watch:{html:function(t){this.setContent(t,!0)}},mounted:function(){this.imgList=[],this.imgList.each=function(t){for(var e=0;e<this.length;e++){var n=t(this[e],e,this);n&&this.setItem(e,n)}},this.imgList.setItem=function(e,n){var i=this;if(n.includes("base64")){this[e]=n;var s=n.match(/data:image\/(\S+?);base64,(\S+)/);if(!s)return;var a="".concat(t.env.USER_DATA_PATH,"/").concat(Date.now(),".").concat(s[1]);l&&l.writeFile({filePath:a,data:s[2],encoding:"base64",success:function(){return i[e]=a}})}else if(this.includes(n)){if("http"!=n.substring(0,4))return this[e]=n;for(var o="",r=0;r<n.length;r++)if(o+=Math.random()>.5?n[r].toUpperCase():n[r],"/"==n[r]&&"/"!=n[r-1]&&"/"!=n[r+1])break;o+=n.substring(r+1),this[e]=o}else this[e]=n},this.setContent(this.html,!0)},beforeDestroy:function(){this.imgList.each((function(e){e&&e.includes(t.env.USER_DATA_PATH)&&l&&l.unlink({filePath:e})}))},methods:{setContent:function(e,n){var s=this;if(this.showWithAnimation&&(this.showAnimation=u),e)if("string"==typeof e){if(this.useCache){var l=c(e);o[l]?this.nodes=o[l]:(this.nodes=a(e,this),o[l]=this.nodes)}else this.nodes=a(e,this);this.$emit("parse",this.nodes)}else if("[object Array]"==Object.prototype.toString.call(e)){if(this.nodes=n?[]:e,e.length&&"Parser"!=e[0].PoweredBy){var f=function t(e){for(var n,i=0;n=e[i++];)if("text"!=n.type){for(var s in n.attrs=n.attrs||{},n.attrs)h.trustAttrs[s]?"string"!=typeof n.attrs[s]&&(n.attrs[s]=n.attrs[s].toString()):n.attrs[s]=void 0;h.LabelHandler(n,d),h.blockTags[n.name]?n.name="div":h.trustTags[n.name]||(n.name="span"),n.children&&n.children.length?(d._STACK.push(n),t(n.children),d._STACK.pop()):n.children=void 0}},d={_imgNum:0,_videoNum:0,_audioNum:0,_domain:this.domain,_protocol:this.domain&&this.domain.includes("://")?this.domain.split("://")[0]:"http",_STACK:[],CssHandler:new r(this.tagStyle)};d.CssHandler.getStyle(""),f(e),this.nodes=e}}else{if("object"!=typeof e||!e.nodes)return console.warn("错误的 html 类型："+typeof e);this.nodes=e.nodes,console.warn("错误的 html 类型：object 类型已废弃，请直接将 html 设置为 object.nodes")}else{if(n)return;this.nodes=[]}i&&(this.document=new i("html",this.html||e,this)),this.$nextTick((function(){s.imgList.length=0,s.videoContexts=[];var e=function e(n){for(var i=function(){var i=n[a];if("trees"==i.$options.name)for(o=!1,r=i.nodes.length;l=i.nodes[--r];)l.c||("img"==l.name?(l.attrs.src&&l.attrs.i&&s.imgList.setItem(l.attrs.i,l.attrs.src),o||(o=!0,s.lazyLoad&&t.createIntersectionObserver?(i._observer&&i._observer.disconnect(),i._observer=t.createIntersectionObserver(i),i._observer.relativeToViewport({top:1e3,bottom:1e3}).observe("._img",(function(t){i.imgLoad=!0,i._observer.disconnect(),i._observer=null}))):i.imgLoad=!0)):"video"==l.name?(c=t.createVideoContext(l.attrs.id,i),c.id=l.attrs.id,s.videoContexts.push(c)):"audio"==l.name&&l.attrs.autoplay?wx.createAudioContext(l.attrs.id,i).play():"title"==l.name&&s.autosetTitle&&"text"==l.children[0].type&&l.children[0].text&&t.setNavigationBarTitle({title:l.children[0].text}));i.$children.length&&e(i.$children)},a=n.length;a--;){var o,r,l,c;i()}};e(s.$children),s.createSelectorQuery().select("._contain").boundingClientRect().exec((function(t){s.width=(t[0]?t[0]:t).width,s.$emit("ready",t)}))}))},getText:function(){var t="";function e(n){if(n)for(var i,s=0;i=n[s++];)if("text"==i.type)t+=i.text;else if("br"==i.type)t+="\n";else{var a="p"==i.name||"div"==i.name||"tr"==i.name||"li"==i.name||"h"==i.name[0]&&i.name[1]>"0"&&i.name[1]<"7";a&&t&&"\n"!=t[t.length-1]&&(t+="\n"),e(i.children),a&&"\n"!=t[t.length-1]?t+="\n":"td"!=i.name&&"th"!=i.name||(t+="\t")}}return e(this.html),t.replace(/&nbsp;/g," ")},navigateTo:function(e){var n=this;if(e.fail=e.fail||function(){},!this.useAnchor)return e.fail({errMsg:"Use-anchor attribute is disabled"});var i=function(i,s){t.createSelectorQuery().in(s||n).select(i).boundingClientRect().selectViewport().scrollOffset().exec((function(n){if(!n||!n[0])return e.fail({errMsg:"Label not found"});t.pageScrollTo({scrollTop:n[1].scrollTop+n[0].top,success:e.success,fail:e.fail})}))};e.id?i("._contain >>> #"+e.id+", ._contain >>> ."+e.id):i("._contain")},tap:function(e){if(this.gestureZoom&&e.timeStamp-this.lastTime<300){if(this.zoomIn)this.animation.translateX(0).scale(1).step(),t.pageScrollTo({scrollTop:(e.touches[0].pageY-e.currentTarget.offsetTop+this.initY)/2-e.touches[0].clientY,duration:400});else{var n=e.touches[0].pageX-e.currentTarget.offsetLeft;this.initY=e.touches[0].pageY-e.currentTarget.offsetTop,this.animation=t.createAnimation({transformOrigin:n+"px "+this.initY+"px 0",timingFunction:"ease-in-out"}),this.animation.scale(2).step(),this.translateMax=n/2,this.translateMin=(n-this.width)/2,this.translateX=0}this.zoomIn=!this.zoomIn,this.showAnimation=this.animation.export()}this.lastTime=e.timeStamp},touchstart:function(t){1==t.touches.length&&(this.initX=this.lastX=t.touches[0].pageX)},touchmove:function(t){var e=t.touches[0].pageX-this.lastX;if(this.zoomIn&&1==t.touches.length&&Math.abs(e)>20){if(this.lastX=t.touches[0].pageX,this.translateX<=this.translateMin&&e<0||this.translateX>=this.translateMax&&e>0)return;this.translateX+=e*Math.abs(this.lastX-this.initX)*.05,this.translateX<this.translateMin&&(this.translateX=this.translateMin),this.translateX>this.translateMax&&(this.translateX=this.translateMax),this.animation.translateX(this.translateX).step(),this.showAnimation=this.animation.export()}},getVideoContext:function(t){if(!t)return this.videoContexts;for(var e=this.videoContexts.length;e--;)if(this.videoContexts[e].id==t)return this.videoContexts[e];return null}}};e.default=f}).call(this,n("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/jyf-parser/jyf-parser-create-component',
    {
        'components/jyf-parser/jyf-parser-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("a744"))
        })
    },
    [['components/jyf-parser/jyf-parser-create-component']]
]);
